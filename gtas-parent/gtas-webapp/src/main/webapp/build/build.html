<style>
    .actions {
        text-align: center;
    }
    .ui-grid {
        width: 100%;
    }
    md-sidenav {
        min-width: 350px !important;
    }
    h2 {
        font-size: 1.2em;
    }
    section {
        margin: 0 auto;
    }
</style>
<md-sidenav class="md-sidenav-left md-whiteframe-z2" md-component-id="query">
    <md-toolbar class="md-theme-light">
        <h2 class="md-toolbar-tools">Review | Confirm {{selectedMode}} Metadata:</h2>
    </md-toolbar>
    <form ng-if="selectedMode == 'query'" name="queryForm">
        <md-content layout-padding>
            <div layout="row" layout-wrap>
                <md-input-container flex>
                    <label>Name</label>
                    <input md-maxlength="20" autofocus required name="title" ng-model="query.title">
                </md-input-container>
            </div>
            <div layout="row" layout-wrap>
                <md-input-container flex>
                    <label>Description</label>
                    <input md-maxlength="100" name="description" ng-model="query.description">
                </md-input-container>
            </div>
        </md-content>
        <div class="actions">
            <md-button ng-click="save.query.cancel()"
                       ng-disabled="saving === true"
                       class="md-raised pull-left">
                <i class="glyphicon glyphicon-cancel"></i> Cancel
            </md-button>
            <md-button ng-click="save.query.confirm()"
                       ng-disabled="saving === true"
                       class="md-raised md-primary pull-right">
                <i class="glyphicon glyphicon-save"></i><i class="glyphicon glyphicon-filter"></i> Confirm Save
            </md-button>
        </div>
    </form>
</md-sidenav>
<md-sidenav class="md-sidenav-right md-whiteframe-z2" md-component-id="rule">
    <md-toolbar class="md-theme-light">
        <h2 class="md-toolbar-tools">Review | Confirm {{selectedMode}} Metadata:</h2>
    </md-toolbar>
    <form ng-if="selectedMode == 'rule'" name="ruleForm">
        <md-content layout-padding>
            <div layout="row" layout-wrap>
                <md-input-container flex>
                    <label>Name</label>
                    <input md-maxlength="20" required name="title" ng-model="rule.title">
                </md-input-container>
            </div>
            <div layout="row" layout-wrap>
                <md-input-container flex>
                    <label>Description</label>
                    <input md-maxlength="100" name="description" ng-model="rule.description">
                </md-input-container>
            </div>
            <div layout="row" layout-wrap>
                <md-checkbox class="md-primary" required ng-model="rule.enabled" aria-label="Enabled">Enabled</md-checkbox>
            </div>
            <div layout="row" layout-wrap>
                <md-datepicker ng-model="rule.startDate" md-placeholder="Start Date"></md-datepicker>
            </div>
            <div layout="row" layout-wrap>
                <md-datepicker ng-model="rule.endDate" md-placeholder="End Date"></md-datepicker>
            </div>
        </md-content>
        <div class="actions">
            <md-button ng-click="save.rule.cancel()"
                       ng-disabled="saving === true"
                       class="md-raised pull-left">
                <i class="glyphicon glyphicon-cancel"></i> Cancel
            </md-button>
            <md-button ng-click="save.rule.confirm()"
                       ng-disabled="saving === true"
                       class="md-raised md-primary pull-right">
                <i class="glyphicon glyphicon-save"></i><i class="glyphicon glyphicon-flag"></i> Confirm Save
            </md-button>
        </div>
    </form>
</md-sidenav>
<md-content flex="" layout-padding="" class="">
    <div layout="column" layout-fill="" layout-align="top center">
        <md-switch class="md-primary" ng-if="mode = 'rule'" aria-label="Rules:" ng-true-value="true" ng-false-value="false" ng-model="allRules" ng-change="updateGrid(allRules)">
            {{getRuleText}}
        </md-switch>
        <div ui-grid="qbGrid" ui-grid-pagination ui-grid-selection ui-grid-exporter class="grid" external-scopes="$scope"></div>
        <section>
            <h2>Conditions:</h2>
            <div id="builder"></div>
            <alert ng-repeat="alert in alerts" type="alert.type" close="closeAlert($index)" ng-class="{'fade-out': alert.expired}">{{alert.msg}}</alert>
            <div class="actions">
                <md-button href="javascript:function(){}();"
                           ng-click="save.query.prompt()"
                           ng-disabled="saving === true"
                           class="md-raised md-primary">
                    <i class="glyphicon glyphicon-save"></i><i class="glyphicon glyphicon-filter"></i>  Save As Query
                </md-button>
                <md-button href="#/query/flights"
                           title="Launch Flight Query Results in new window"
                           ng-disabled="ruleId === null || saving === true"
                           target="queryFlights" ng-click="executeQuery('flights')"
                           class="md-raised">
                    <i class="glyphicon glyphicon-filter"></i><i class="glyphicon glyphicon-plane"></i> Query Flights
                </md-button>
                <md-button href="#/query/passengers"
                           ng-disabled="ruleId === null || saving === true"
                           title="Launch Passengers Query Results in new window"
                           target="queryPassengers" ng-click="executeQuery('flights')"
                           class="md-raised">
                    <i class="glyphicon glyphicon-filter"></i><i class="glyphicon glyphicon-user"></i>  Query Passengers
                </md-button>

                <md-button ng-click="newRule()"
                           ng-disabled="ruleId === null"
                           class="md-raised pull-left">
                    <i class="glyphicon glyphicon-plus"></i> Add New {{mode}}
                </md-button>
                <md-button ng-click="resetQueryBuilder()"
                           class="md-raised pull-left">
                    <i class="glyphicon glyphicon-minus"></i> Clear Conditions
                </md-button>
                <md-button ng-click="save.rule.prompt()"
                           ng-disabled="saving === true"
                           class="md-raised md-primary pull-right">
                    <i class="glyphicon glyphicon-save"></i><i class="glyphicon glyphicon-flag"></i> Save As Rule
                </md-button>
                <md-button ng-click="copy()"
                           ng-disabled="ruleId === null || saving === true || allRules == false"
                           class="md-raised pull-right">
                    <i class="glyphicon glyphicon-duplicate"></i> Copy {{mode}}
                </md-button>
                <md-button ng-click="delete()"
                           ng-disabled="ruleId === null"
                           class="md-raised md-warn pull-right">
                    <i class="glyphicon glyphicon-erase"></i> Delete
                </md-button>
            </div>
        </section>
    </div>
</md-content>
